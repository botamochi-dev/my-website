---
import { Icon } from 'astro-icon/components';

import PostTags from '~/components/blog/Tags.astro';

import { APP_BLOG } from 'astrowind:config';
import type { Post } from '~/types';

import { getPermalink } from '~/utils/permalinks';

import { getFormattedDate } from '~/utils/utils';

export interface Props {
  post: Post;
}

const { post } = Astro.props;

const link = APP_BLOG?.post?.isEnabled ? getPermalink(post.permalink, 'post') : '';
---

<article class="flex">
  <div class="flex flex-col items-center mr-4 md:mr-6 shrink-0 min-w-[80px] md:min-w-[100px]">
    <div class="text-sm font-medium text-gray-500 dark:text-gray-400 py-1">{getFormattedDate(post.publishDate)}</div>
    <div class="w-px bg-gray-200 dark:bg-slate-700 h-full relative flex-1">
      <div
        class="absolute top-0 left-1/2 -translate-x-1/2 w-3 h-3 rounded-full border-2 border-white dark:border-slate-900 bg-primary dark:bg-blue-600"
      >
      </div>
    </div>
  </div>

  <div class="flex-1 pb-10 md:pb-16">
    <header>
      <div class="mb-2 text-sm text-muted dark:text-slate-400">
        {
          post.author && (
            <>
              <Icon name="tabler:user" class="w-3.5 h-3.5 inline-block -mt-0.5" />
              <span>{post.author.replaceAll('-', ' ')}</span>
            </>
          )
        }
        {
          post.category && (
            <>
              {' '}
              Â·{' '}
              <a class="hover:underline" href={getPermalink(post.category.slug, 'category')}>
                {post.category.title}
              </a>
            </>
          )
        }
      </div>
      <h2 class="text-xl sm:text-2xl font-bold leading-tight mb-2 font-heading dark:text-slate-300">
        {
          link ? (
            <a
              class="inline-block hover:text-primary dark:hover:text-blue-700 transition ease-in duration-200"
              href={link}
            >
              {post.title}
            </a>
          ) : (
            post.title
          )
        }
      </h2>
    </header>

    {
      post.tags && Array.isArray(post.tags) ? (
        <footer class="mt-5">
          <PostTags tags={post.tags} />
        </footer>
      ) : (
        <Fragment />
      )
    }
  </div>
</article>
